SELECT account_id,
       occurred_at,
       standard_qty,
       gloss_qty, poster_qty,gloss_qty+ poster_qty
FROM demo.orders

############
Error Message (As new_column_name)

Q:
قم بإنشاء أحد الأعمدة التي تقوم بتقسيم standard_amt_usd باستخدام standard_qty للعثور على سعر الوحدة للورقة القياسية لكل ترتيب. قصر النتائج على أول 10 طلبات، وتضمين الحقلين id وaccount_id. ملاحظة - ستتلقى رسالة خطأ ومعها الحل الصحيح لهذا السؤال. هذا هو التقسيم بالصفر. ستتعرف على كيفية الحصول على أحد الحلول دون رسالة خطأ لهذا الاستعلام عندما تتعرف على عبارات CASE في قسم آخر. والآن، يمكنك فقط إضافة قيمة صغيرة للغاية إلى المقام كحل.


اكتب استعلامًا يجد النسبة المئوية للإيراد الوارد من ورقة ملصق لكل طلب. ستكون بحاجة لاستخدام الأعمدة التي تنتهي بـ _usd فقط. (جرّب القيام بذلك دون استخدام العمود الإجمالي). قم بتضمين الحقلين id وaccount_id. ملاحظة - ستتلقى رسالة خطأ ومعها الحل الصحيح لهذا السؤال. هذا هو التقسيم بالصفر. ستتعرف على كيفية الحصول على أحد الحلول دون رسالة خطأ لهذا الاستعلام عندما تتعرف على عبارات CASE في قسم آخر. والآن، يمكنك فقط إضافة قيمة صغيرة للغاية إلى المقام كحل.
Sol:
إليك الاستعلام الذي يجب أن يوفر أحد الحلول. ستلاحظ أنك تلقيت خطأ لأنك قسمت على الصفر. سننتقل بك خلال العبارات CASE قبل نهاية هذه الفئة، لذا فأنت تعرف الحل لهذا الخطأ. والحل السهل (ولكن ليس دقيقًا بشكل كامل) هو ببساطة إضافة 1 إلى المقام.
SELECT id, account_id, standard_amt_usd/standard_qty AS unit_price
FROM orders
LIMIT 10;
SELECT id, account_id, 
       poster_amt_usd/(standard_amt_usd + gloss_amt_usd + poster_amt_usd) AS post_per
FROM orders;
